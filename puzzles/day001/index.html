<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Daily Cryptojoke</title>

<style>
:root{
  --teal:#008080;
  --teal-dark:#006a6a;
  --gold:#d8c178;
  --bg:#f5f6f7;
  --panel:#ffffff;
  --ink:#1e1e1e;
  --muted:#6b6b6b;
  --line:#b9b9b9;
}

body{
  margin:0;
  background:var(--bg);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  color:var(--ink);
}

/* HEADER — MATCH WORD SEARCH */
header{
  background:var(--teal);
  color:#fff;
  padding:14px 8px;
  text-align:center;
  border-bottom:3px solid var(--teal-dark);
}
header h1{
  margin:0;
  font-size:22px;
  letter-spacing:.4px;
}
header h2{
  margin:4px 0 0;
  font-size:15px;
  font-weight:600;
}

/* LAYOUT */
.wrap{
  max-width:620px;
  margin:10px auto;
  padding:10px;
}
.panel{
  background:var(--panel);
  border:1px solid #e2e2e2;
  border-radius:14px;
  padding:12px;
  box-shadow:0 2px 8px rgba(0,0,0,.04);
}
.subtitle{
  text-align:center;
  color:var(--muted);
  font-size:13px;
  font-style:italic;
  margin:8px 0 12px;
}

/* GRID */
#cryptogram{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:10px 6px;
  font-family:monospace;
  font-size:clamp(15px, 3.6vw, 18px);
  line-height:1.5;
  margin-bottom:12px;
}

.word{
  display:inline-flex;
  flex-wrap:nowrap;
  align-items:flex-end;
  margin-right:8px;
  transition:transform .2s ease;
  transform-origin:left center;
}

.cell{
  display:flex;
  flex-direction:column;
  align-items:center;
}

.cell .cipher{
  font-weight:800;
  color:var(--teal);
  font-size:clamp(14px, 3.2vw, 17px);
  margin-bottom:4px;
}

.cell input{
  width:38px; height:38px;
  font-size:18px;
  text-align:center;
  text-transform:uppercase;
  border:1px solid var(--line);
  border-radius:6px;
  background:#fff;
}
.cell input:focus{
  outline:none;
  border-color:var(--teal);
  background:#e8f8fb;
}

.punct{
  margin-left:6px;
  font-weight:800;
  color:var(--teal);
}

/* CONTROLS — MATCH WORD SEARCH */
.controls{
  text-align:center;
  margin-top:10px;
}
.btn{
  background:#fff;
  color:var(--teal);
  border:1px solid var(--teal);
  padding:9px 14px;
  border-radius:10px;
  font-weight:700;
  font-size:14px;
}
.btn:active{ background:var(--gold); color:#000; }

/* FIT LONG WORDS */
@media(max-width:420px){
  .wrap{ padding:8px; }
}
</style>
</head>

<body>

<header>
  <h1>Daily Cryptojoke</h1>
  <h2>{{DAY_LABEL}}</h2>
</header>

<div class="wrap">
  <div class="subtitle">Type your guesses below each letter. Progress saves automatically.</div>

  <div class="panel">
    <div id="cryptogram" aria-live="polite"></div>
  </div>

  <div class="controls">
    <button id="clearBtn" class="btn">Clear My Answers</button>
  </div>
</div>

<script>
(function(){
/* ===== CONFIG (EDIT ONLY THESE TWO) ===== */

// Put ONLY the encrypted text here (A–Z, spaces, punctuation).
const PHRASE = "FSW ROR DST CZQNTZNLF FOH QH QFQNR? MTZQACT ST FQC LADCDQHROHP OH SOC YOTIR.";

// LocalStorage namespace per day (change per puzzle)
const LS_KEY = "cryptojoke_day_XX";

/* ===== DO NOT EDIT BELOW ===== */

const CLEAR_FLAG = "cryptojoke-cleared";
const container = document.getElementById("cryptogram");
const clearBtn = document.getElementById("clearBtn");

function setCookie(name,value,days){
  const d=new Date(); d.setTime(d.getTime()+days*864e5);
  document.cookie=`${name}=${value};expires=${d.toUTCString()};path=/`;
}
function getCookie(name){
  const m=document.cookie.match(new RegExp('(^|; )'+name+'=([^;]*)'));
  return m?decodeURIComponent(m[2]):"";
}

const isCleared = getCookie(CLEAR_FLAG)==="true";
let saved={};
try{
  if(!isCleared){
    const raw=localStorage.getItem(LS_KEY);
    if(raw) saved=JSON.parse(raw);
  }
}catch(e){}

const inputs=[];

// Build grid
PHRASE.split(" ").forEach((word,wIndex)=>{
  const wordDiv=document.createElement("div");
  wordDiv.className="word";

  [...word].forEach((ch,cIndex)=>{
    if(/[A-Z]/.test(ch)){
      const cell=document.createElement("div"); cell.className="cell";
      const top=document.createElement("div"); top.className="cipher"; top.textContent=ch;
      const box=document.createElement("input"); box.maxLength=1;

      const id=`${wIndex}-${cIndex}`;
      if(saved[id]) box.value=saved[id];

      box.addEventListener("input", e=>{
        e.target.value=e.target.value.toUpperCase().replace(/[^A-Z]/g,"").slice(0,1);
        if(e.target.value) saved[id]=e.target.value;
        else delete saved[id];
        localStorage.setItem(LS_KEY,JSON.stringify(saved));
        setCookie(CLEAR_FLAG,"false",7);
      });

      cell.appendChild(top); cell.appendChild(box);
      wordDiv.appendChild(cell);
      inputs.push({id,box});
    }else{
      const p=document.createElement("div"); p.className="punct"; p.textContent=ch;
      wordDiv.appendChild(p);
    }
  });

  container.appendChild(wordDiv);
});

// Clear button
clearBtn.addEventListener("click", ()=>{
  inputs.forEach(({box})=>box.value="");
  localStorage.removeItem(LS_KEY);
  setCookie(CLEAR_FLAG,"true",7);
});

// Fit long words on small screens
function fitLongestWord(){
  const words=container.querySelectorAll(".word");
  const parentWidth=container.clientWidth;
  words.forEach(w=>{
    w.style.transform="scale(1)";
    const rect=w.getBoundingClientRect();
    const scale = rect.width>parentWidth ? (parentWidth/rect.width - .05) : 1;
    if(scale<1) w.style.transform=`scale(${scale})`;
  });
}
window.addEventListener("resize",()=>setTimeout(fitLongestWord,80));
window.addEventListener("load",()=>setTimeout(fitLongestWord,80));
})();
</script>

</body>
</html>
